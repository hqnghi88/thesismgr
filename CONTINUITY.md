# Ledger: thesis-mgr

- Goal: Restructure the template into a Thesis CMS with automatic jury timeslot planning and comprehensive Admin management.
- Constraints/Assumptions:
    - Backend: Express/Mongoose.
    - Frontend: React/Vite.
    - Roles: Student, Professor, Admin.
    - Jury structure: Student, Supervisor, 1 Principal (Prof), 1 Examinator (Prof).
- Key decisions:
    - Implemented role-based access control (RBAC).
    - Created Thesis and Schedule models with specific jury roles.
    - Developed an auto-planning algorithm for defenses.
    - Added Admin pages for user and thesis oversight.
- State:
    - Done:
        - Full Dockerization (backend, frontend, mongodb) with docker-compose.
        - Enabled Hot-Reload (Auto-Update) using Docker Volumes and Nodemon.

        - Full project restructuring into a Thesis CMS.
        - Admin user management implemented with full CRUD.
        - Thesis audit and assignment capabilities added with Delete support.
        - Excel Import feature implemented for bulk data entry (Theses and Users).
        - Refined auto-planning logic to match `juries.xlsx` template (35-min slots, 07:15/13:30 shifts).
        - Excel Export feature to download schedules in template format.
        - Implemented exact-layout DOCX (Word) export for schedules using 'docx' library.
        - Updated import logic to support new Excel format (headers like "Mã sinh viên", "Tên luận văn", "Họ và Tên").
        - Fixed Thesis Import logic to skip header/template placeholder rows.
        - Implemented Upsert logic for thesis import (prevents duplicates, updates existing).
        - Performed manual cleanup of "junk" data imported from Excel templates.
        - Edit functionality added to thesis cards (students can edit their own theses).
        - Edit functionality added to schedule/planning cards (admins can modify jury, time, room).
        - Manual removal (Delete) of schedules verified.
        - Implemented professor and room conflict detection for scheduling.
        - Completely redesigned UI using Bootstrap for a professional look.
        - Ensured full mobile responsiveness across all admin pages.
        - Added Timetable view to the Planning page with quick inline editing (swap professors, shift time, change room).
        - Enabled quick professor role swapping (Principal, Examinator) directly in List View and Timetable.
        - Made Supervisor role read-only in planning views to maintain data integrity.
        - Enforced jury member uniqueness (Principal, Examinator, Supervisor must be different).
        - Added bulk delete feature for professors and students.
        - Added bulk delete feature for all theses (automatically clears schedules too).
        - Added bulk delete feature for all schedules (resets thesis statuses to approved).
        - Refined thesis import logic to reuse existing professors by name matching (avoids duplicate accounts).
        - Implemented data integrity checks to prevent deleting users who are active in the schedule (avoids blank/orphaned positions).
        - Added visual placeholders ("⚠️ Missing Member") in the UI to easily identify any remaining orphaned records.

    - Now:
        - All requested features implemented and verified.

    - Next:
        - Maintenance or further feature expansion as requested by the user.
- Open questions:
    - None.
- Working set:
    - `backend/models/*.js`
    - `backend/controllers/*.js`
    - `backend/routes/*.js`
    - `frontend/src/pages/*.jsx`
    - `frontend/src/components/*.jsx`
